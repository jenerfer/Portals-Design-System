<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dropdowns — Portals Style Guide</title>
  <link rel="stylesheet" href="../styles.css">
  <script>
    (function(){var t=localStorage.getItem('portals-theme');if(t==='dark')document.documentElement.setAttribute('data-theme','dark');})();
  </script>
</head>
<body>

  <!-- Top Bar -->
  <header class="style-guide__topbar">
    <a href="../index.html" class="style-guide__topbar-logo">
      <img src="../portals-logo.svg" alt="Portals">
    </a>
    <nav class="style-guide__topbar-nav">
      <a href="../index.html" class="topbar-link topbar-link--active">Style Guide</a>
      <a href="#" class="topbar-link">Components</a>
      <a href="#" class="topbar-link">Resources</a>
    </nav>
  </header>

  <div class="style-guide">

    <!-- Sidebar Navigation -->
    <nav class="style-guide__sidebar">
      <div class="style-guide__sidebar-nav">

        <!-- Foundation -->
        <details class="sidebar-category">
          <summary>Foundation</summary>
          <div class="sidebar-category__content">
            <div class="sidebar-category__inner">
              <a href="typography.html" class="sidebar-link">Typography</a>
              <a href="colors.html" class="sidebar-link">Colors</a>
            </div>
          </div>
        </details>

        <!-- Input & Selection (active) -->
        <details class="sidebar-category" open>
          <summary>Input & Selection</summary>
          <div class="sidebar-category__content">
            <div class="sidebar-category__inner">
              <a href="buttons.html" class="sidebar-link">Buttons & Toggles</a>
              <a href="radio.html" class="sidebar-link">Radio & Checkmarks</a>
              <a href="dropdowns.html" class="sidebar-link sidebar-link--active">Dropdowns</a>
              <a href="#date-picker" class="sidebar-link">Date picker</a>
              <a href="#file-upload" class="sidebar-link">File upload</a>
              <a href="form-fields.html" class="sidebar-link">Form fields</a>
              <a href="#menu" class="sidebar-link">Menu</a>
              <a href="#segmented-control" class="sidebar-link">Segmented control</a>
              <a href="#slider" class="sidebar-link">Slider</a>
              <a href="#star-rating" class="sidebar-link">Star rating</a>
              <a href="#stepper" class="sidebar-link">Stepper</a>
              <a href="#switch" class="sidebar-link">Switch</a>
              <a href="#time-picker" class="sidebar-link">Time picker</a>
            </div>
          </div>
        </details>

        <!-- Navigation -->
        <details class="sidebar-category">
          <summary>Navigation</summary>
          <div class="sidebar-category__content">
            <div class="sidebar-category__inner">
              <a href="#breadcrumbs" class="sidebar-link">Breadcrumbs</a>
              <a href="#bottom-navigation" class="sidebar-link">Bottom navigation</a>
              <a href="#link" class="sidebar-link">Link</a>
              <a href="#navigation-header" class="sidebar-link">Navigation header</a>
              <a href="#page-controls" class="sidebar-link">Page controls</a>
              <a href="#pagination" class="sidebar-link">Pagination</a>
              <a href="#side-navigation" class="sidebar-link">Side navigation</a>
              <a href="#tabs" class="sidebar-link">Tabs</a>
              <a href="#top-navigation" class="sidebar-link">Top navigation</a>
            </div>
          </div>
        </details>

        <!-- Indicators and status -->
        <details class="sidebar-category">
          <summary>Indicators and status</summary>
          <div class="sidebar-category__content">
            <div class="sidebar-category__inner">
              <a href="#badge" class="sidebar-link">Badge</a>
              <a href="#empty-state" class="sidebar-link">Empty state</a>
              <a href="#placeholder" class="sidebar-link">Placeholder</a>
              <a href="#progress-bar" class="sidebar-link">Progress bar</a>
              <a href="#progress-circle" class="sidebar-link">Progress circle</a>
              <a href="#progress-steps" class="sidebar-link">Progress steps</a>
              <a href="#tag" class="sidebar-link">Tag</a>
            </div>
          </div>
        </details>

        <!-- Content display -->
        <details class="sidebar-category">
          <summary>Content display</summary>
          <div class="sidebar-category__content">
            <div class="sidebar-category__inner">
              <a href="accordion.html" class="sidebar-link">Accordion</a>
              <a href="#avatar" class="sidebar-link">Avatar</a>
              <a href="cards.html" class="sidebar-link">Cards</a>
              <a href="#draggable-list" class="sidebar-link">Draggable list</a>
              <a href="#list-item" class="sidebar-link">List item</a>
              <a href="#section-heading" class="sidebar-link">Section heading</a>
              <a href="#tile" class="sidebar-link">Tile</a>
              <a href="friends-module.html" class="sidebar-link">Friends module</a>
            </div>
          </div>
        </details>

      </div>

      <!-- Theme Toggle -->
      <button class="theme-toggle" aria-label="Toggle dark mode">
        <span class="theme-toggle__icon theme-toggle__sun">
          <svg viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M11.0128 18.0323C14.8858 18.0323 18.0255 14.8926 18.0255 11.0196C18.0255 7.14655 14.8858 4.00684 11.0128 4.00684C7.13972 4.00684 4 7.14655 4 11.0196C4 14.8926 7.13972 18.0323 11.0128 18.0323Z" fill="currentColor"/>
            <path d="M11.02 22C10.469 22 10.0182 21.5893 10.0182 21.0383V20.9581C10.0182 20.4071 10.469 19.9563 11.02 19.9563C11.571 19.9563 12.0219 20.4071 12.0219 20.9581C12.0219 21.5091 11.571 22 11.02 22ZM18.173 19.1749C17.9126 19.1749 17.6621 19.0747 17.4617 18.8843L17.3315 18.7541C16.9408 18.3634 16.9408 17.7322 17.3315 17.3415C17.7222 16.9508 18.3534 16.9508 18.7441 17.3415L18.8743 17.4718C19.265 17.8625 19.265 18.4936 18.8743 18.8843C18.684 19.0747 18.4335 19.1749 18.173 19.1749ZM3.86703 19.1749C3.60656 19.1749 3.3561 19.0747 3.15574 18.8843C2.76503 18.4936 2.76503 17.8625 3.15574 17.4718L3.28597 17.3415C3.67669 16.9508 4.30783 16.9508 4.69854 17.3415C5.08925 17.7322 5.08925 18.3634 4.69854 18.7541L4.56831 18.8843C4.37796 19.0747 4.11749 19.1749 3.86703 19.1749ZM21.0383 12.0219H20.9581C20.4071 12.0219 19.9563 11.571 19.9563 11.02C19.9563 10.469 20.4071 10.0182 20.9581 10.0182C21.5091 10.0182 22 10.469 22 11.02C22 11.571 21.5893 12.0219 21.0383 12.0219ZM1.08197 12.0219H1.00182C0.45082 12.0219 0 11.571 0 11.02C0 10.469 0.45082 10.0182 1.00182 10.0182C1.55282 10.0182 2.04372 10.469 2.04372 11.02C2.04372 11.571 1.63297 12.0219 1.08197 12.0219ZM18.0428 4.99909C17.7823 4.99909 17.5319 4.89891 17.3315 4.70856C16.9408 4.31785 16.9408 3.6867 17.3315 3.29599L17.4617 3.16576C17.8525 2.77505 18.4836 2.77505 18.8743 3.16576C19.265 3.55647 19.265 4.18761 18.8743 4.57832L18.7441 4.70856C18.5537 4.89891 18.3033 4.99909 18.0428 4.99909ZM3.99727 4.99909C3.73679 4.99909 3.48634 4.89891 3.28597 4.70856L3.15574 4.56831C2.76503 4.1776 2.76503 3.54645 3.15574 3.15574C3.54645 2.76503 4.1776 2.76503 4.56831 3.15574L4.69854 3.28597C5.08925 3.67669 5.08925 4.30783 4.69854 4.69854C4.5082 4.89891 4.24772 4.99909 3.99727 4.99909ZM11.02 2.04372C10.469 2.04372 10.0182 1.63297 10.0182 1.08197V1.00182C10.0182 0.45082 10.469 0 11.02 0C11.571 0 12.0219 0.45082 12.0219 1.00182C12.0219 1.55282 11.571 2.04372 11.02 2.04372Z" fill="currentColor"/>
          </svg>
        </span>
        <span class="theme-toggle__icon theme-toggle__moon">
          <svg viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21.8215 15.3305C21.6399 15.0333 21.1291 14.5711 19.8577 14.7912C19.154 14.9122 18.4389 14.9673 17.7237 14.9342C15.0789 14.8242 12.6838 13.6466 11.0152 11.8306C9.53956 10.2348 8.63146 8.15465 8.62011 5.90946C8.62011 4.65479 8.86984 3.44415 9.38064 2.29954C9.88009 1.18795 9.5282 0.604643 9.27848 0.362515C9.0174 0.10938 8.40444 -0.242806 7.20122 0.241451C2.5586 2.13446 -0.313242 6.64685 0.0272929 11.4784C0.367827 16.0238 3.65966 19.9089 8.0185 21.3727C9.06281 21.7249 10.1639 21.934 11.299 21.978C11.4806 21.989 11.6622 22 11.8438 22C15.6465 22 19.2107 20.2611 21.4583 17.3005C22.2188 16.277 22.0145 15.6276 21.8215 15.3305Z" fill="currentColor"/>
          </svg>
        </span>
      </button>
    </nav>

    <!-- Main Content -->
    <main class="style-guide__content">

      <!-- Page Header -->
      <div class="page-header">
        <h2 class="page-header__title">dropdowns</h2>
        <p class="page-header__description">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation</p>
      </div>

      <!-- ==================== DROPDOWNS ==================== -->
      <section class="style-guide__section" id="dropdowns">

        <!-- Dropdown Filters -->
        <div class="component-display">
          <div class="component-display__label">dropdown filters</div>
          <div class="dropdown-filter-bar">

            <!-- ===== Category Dropdown ===== -->
            <div class="dropdown" id="dropdown-demo">
              <!-- Trigger button -->
              <button class="dropdown-trigger" id="dropdown-trigger">
                <span class="dropdown-trigger__text">all</span>
                <span class="dropdown-trigger__icon">
                  <span class="dropdown-trigger__icon-pill">
                    <!-- Chevron down -->
                    <svg class="dropdown-chevron" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </span>
                  <!-- Close ✕ (hidden by default) -->
                  <svg class="dropdown-close-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                    <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </button>

              <!-- Dropdown panel -->
              <div class="dropdown-panel" id="dropdown-panel">
                <div class="dropdown-panel__header">
                  <span class="dropdown-panel__title">category</span>
                  <button class="dropdown-panel__close" id="dropdown-close">
                    <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                </div>

                <!-- "all" option -->
                <div class="dropdown-item" data-category="all">
                  <span class="dropdown-item__text">all</span>
                  <span class="dropdown-radio dropdown-radio--selected"></span>
                </div>

                <!-- Parent: body (has children) -->
                <div class="dropdown-item" data-category="body" data-has-children="true">
                  <span class="dropdown-item__text">body</span>
                  <span class="dropdown-radio"></span>
                </div>
                <div class="dropdown-subcategory" data-parent="body">
                  <div class="dropdown-subcategory__parent">
                    <span class="dropdown-subcategory__parent-text">body</span>
                    <span class="dropdown-radio"></span>
                  </div>
                  <div class="dropdown-subcategory__children">
                    <div class="dropdown-subcategory__item" data-child="full body items">
                      <span class="dropdown-subcategory__text">full body items</span>
                      <span class="dropdown-radio"></span>
                    </div>
                    <div class="dropdown-subcategory__item" data-child="hair">
                      <span class="dropdown-subcategory__text">hair</span>
                      <span class="dropdown-radio"></span>
                    </div>
                    <div class="dropdown-subcategory__item" data-child="heads">
                      <span class="dropdown-subcategory__text">heads</span>
                      <span class="dropdown-radio"></span>
                    </div>
                  </div>
                </div>

                <!-- Parent: clothing (has children) -->
                <div class="dropdown-item" data-category="clothing" data-has-children="true">
                  <span class="dropdown-item__text">clothing</span>
                  <span class="dropdown-radio"></span>
                </div>
                <div class="dropdown-subcategory" data-parent="clothing">
                  <div class="dropdown-subcategory__parent">
                    <span class="dropdown-subcategory__parent-text">clothing</span>
                    <span class="dropdown-radio"></span>
                  </div>
                  <div class="dropdown-subcategory__children">
                    <div class="dropdown-subcategory__item" data-child="tops">
                      <span class="dropdown-subcategory__text">tops</span>
                      <span class="dropdown-radio"></span>
                    </div>
                    <div class="dropdown-subcategory__item" data-child="bottoms">
                      <span class="dropdown-subcategory__text">bottoms</span>
                      <span class="dropdown-radio"></span>
                    </div>
                    <div class="dropdown-subcategory__item" data-child="shoes">
                      <span class="dropdown-subcategory__text">shoes</span>
                      <span class="dropdown-radio"></span>
                    </div>
                  </div>
                </div>

                <!-- accessories (has children) -->
                <div class="dropdown-item" data-category="accessories" data-has-children="true">
                  <span class="dropdown-item__text">accessories</span>
                  <span class="dropdown-radio"></span>
                </div>
                <div class="dropdown-subcategory" data-parent="accessories">
                  <div class="dropdown-subcategory__parent">
                    <span class="dropdown-subcategory__parent-text">accessories</span>
                    <span class="dropdown-radio"></span>
                  </div>
                  <div class="dropdown-subcategory__children">
                    <div class="dropdown-subcategory__item" data-child="back">
                      <span class="dropdown-subcategory__text">back</span>
                      <span class="dropdown-radio"></span>
                    </div>
                    <div class="dropdown-subcategory__item" data-child="waist">
                      <span class="dropdown-subcategory__text">waist</span>
                      <span class="dropdown-radio"></span>
                    </div>
                  </div>
                </div>

                <!-- animations (no children) -->
                <div class="dropdown-item" data-category="animations">
                  <span class="dropdown-item__text">animations</span>
                  <span class="dropdown-radio"></span>
                </div>

                <!-- Apply button -->
                <button class="dropdown-apply dropdown-apply--inactive" id="dropdown-apply">Apply</button>
              </div>
            </div>

            <!-- ===== Search Dropdown (Creator) ===== -->
            <div class="dropdown" id="dropdown-search">
              <!-- Trigger button -->
              <button class="dropdown-trigger" id="search-trigger">
                <span class="dropdown-trigger__text">all creators</span>
                <span class="dropdown-trigger__icon">
                  <span class="dropdown-trigger__icon-pill">
                    <svg class="dropdown-chevron" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </span>
                  <svg class="dropdown-close-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                    <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </button>

              <!-- Dropdown panel -->
              <div class="dropdown-panel" id="search-panel">
                <div class="dropdown-panel__header">
                  <span class="dropdown-panel__title">creator</span>
                  <button class="dropdown-panel__close" id="search-close">
                    <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                </div>

                <input type="text" class="dropdown-search-input" id="search-input" placeholder="search for a creator">

                <button class="dropdown-apply dropdown-apply--inactive" id="search-apply">Apply</button>
              </div>
            </div>

            <!-- ===== Price Dropdown ===== -->
            <div class="dropdown" id="dropdown-price">
              <!-- Trigger button -->
              <button class="dropdown-trigger" id="price-trigger">
                <span class="dropdown-trigger__text">any price</span>
                <span class="dropdown-trigger__icon">
                  <span class="dropdown-trigger__icon-pill">
                    <svg class="dropdown-chevron" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </span>
                  <svg class="dropdown-close-icon" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                    <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </button>

              <!-- Dropdown panel -->
              <div class="dropdown-panel dropdown-panel--wide" id="price-panel">
                <div class="dropdown-panel__header">
                  <span class="dropdown-panel__title">price</span>
                  <button class="dropdown-panel__close" id="price-close">
                    <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </button>
                </div>

                <!-- Any price option -->
                <div class="dropdown-price-item" id="price-any">
                  <span class="dropdown-price-item__text">any price</span>
                  <span class="dropdown-radio dropdown-radio--selected" id="price-any-radio"></span>
                </div>

                <!-- Price range row -->
                <div class="dropdown-price-row">
                  <div class="dropdown-price-field">
                    <input type="text" inputmode="numeric" class="dropdown-price-input" id="price-min" placeholder="min">
                    <span class="dropdown-price-token">
                      <img src="../coin.png" alt="" width="22" height="23">
                    </span>
                  </div>
                  <div class="dropdown-price-field">
                    <input type="text" inputmode="numeric" class="dropdown-price-input" id="price-max" placeholder="max">
                    <span class="dropdown-price-token">
                      <img src="../coin.png" alt="" width="22" height="23">
                    </span>
                  </div>
                  <span class="dropdown-radio" id="price-range-radio"></span>
                </div>

                <button class="dropdown-apply dropdown-apply--inactive" id="price-apply">Apply</button>
              </div>
            </div>

          </div>
        </div>

        <!-- Simple Dropdown Selection -->
        <div class="component-display">
          <div class="component-display__label">simple dropdown selection</div>
          <div class="component-display__row">
            <div class="component-display__column">

              <div class="select-dropdown" id="select-dropdown-demo">
                <label class="select-dropdown__label">language</label>
                <button class="select-dropdown__trigger" id="select-trigger">
                  <span class="select-dropdown__trigger-text" id="select-trigger-text">select language</span>
                  <span class="select-dropdown__trigger-icon">
                    <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </span>
                </button>
                <div class="select-dropdown__panel" id="select-panel">
                  <button class="select-dropdown__option" data-value="bahasa">Bahasa Indonesia</button>
                  <button class="select-dropdown__option" data-value="deutsch">Deutsch</button>
                  <button class="select-dropdown__option select-dropdown__option--selected" data-value="english-us">English (United States)</button>
                  <button class="select-dropdown__option" data-value="espanol">Español (España)</button>
                  <button class="select-dropdown__option" data-value="francais">Français (France)</button>
                  <button class="select-dropdown__option" data-value="italiano">Italiano</button>
                  <button class="select-dropdown__option" data-value="polski">Polski</button>
                  <button class="select-dropdown__option" data-value="portugues">Português (Brasil)</button>
                  <button class="select-dropdown__option" data-value="tieng-viet">Tiếng Việt</button>
                  <button class="select-dropdown__option" data-value="turkce">Türkçe</button>
                </div>
              </div>

            </div>
          </div>
        </div>

      </section>

    </main>
  </div>

  <script src="../sidebar.js"></script>
  <script>
    // Shared registry — only one dropdown open at a time
    var dropdownClosers = [];
    function registerDropdown(closeFn) { dropdownClosers.push(closeFn); }
    function closeAllDropdowns() { dropdownClosers.forEach(function (fn) { fn(); }); }

    (function () {
      var dropdown = document.getElementById('dropdown-demo');
      var trigger = document.getElementById('dropdown-trigger');
      var panel = document.getElementById('dropdown-panel');
      var closeBtn = document.getElementById('dropdown-close');
      var applyBtn = document.getElementById('dropdown-apply');
      var triggerText = trigger.querySelector('.dropdown-trigger__text');
      var chevronPill = trigger.querySelector('.dropdown-trigger__icon-pill');
      var closeIcon = trigger.querySelector('.dropdown-close-icon');

      // State
      var isOpen = false;
      var selectedParent = null;
      var selectedChildren = [];
      var isAllSelected = true;

      // --- Helpers ---

      function openPanel() {
        closeAllDropdowns();
        isOpen = true;
        panel.classList.add('dropdown-panel--open');
        trigger.classList.add('dropdown-trigger--open');
      }

      function closePanel() {
        isOpen = false;
        panel.classList.remove('dropdown-panel--open');
        trigger.classList.remove('dropdown-trigger--open');
      }

      registerDropdown(closePanel);

      function collapseAllSubcategories() {
        var subs = panel.querySelectorAll('.dropdown-subcategory');
        subs.forEach(function (sub) {
          sub.classList.remove('dropdown-subcategory--open');
        });
        // Remove parent-selected and hidden classes from all items
        var items = panel.querySelectorAll('.dropdown-item');
        items.forEach(function (item) {
          item.classList.remove('dropdown-item--parent-selected');
          item.classList.remove('dropdown-item--hidden');
        });
      }

      function deselectAllRadios() {
        var radios = panel.querySelectorAll('.dropdown-radio');
        radios.forEach(function (r) {
          r.classList.remove('dropdown-radio--selected');
        });
      }

      function selectAll() {
        isAllSelected = true;
        selectedParent = null;
        selectedChildren = [];
        deselectAllRadios();
        collapseAllSubcategories();
        // Select the "all" radio
        var allItem = panel.querySelector('[data-category="all"]');
        if (allItem) {
          allItem.querySelector('.dropdown-radio').classList.add('dropdown-radio--selected');
        }
        // Make apply inactive
        applyBtn.classList.add('dropdown-apply--inactive');
      }

      function updateApplyButton() {
        if (isAllSelected) {
          applyBtn.classList.add('dropdown-apply--inactive');
        } else {
          applyBtn.classList.remove('dropdown-apply--inactive');
        }
      }

      function setSelectedState(name) {
        trigger.classList.remove('dropdown-trigger--open');
        trigger.classList.add('dropdown-trigger--selected');
        triggerText.textContent = name;
        chevronPill.style.display = 'none';
        closeIcon.style.display = 'block';
      }

      function resetToDefault() {
        trigger.classList.remove('dropdown-trigger--selected');
        trigger.classList.remove('dropdown-trigger--open');
        triggerText.textContent = 'all';
        chevronPill.style.display = 'inline-flex';
        closeIcon.style.display = 'none';
        selectAll();
        closePanel();
      }

      // --- Trigger click ---
      trigger.addEventListener('click', function (e) {
        e.stopPropagation();

        // If in selected state, clicking the ✕ resets
        if (trigger.classList.contains('dropdown-trigger--selected')) {
          resetToDefault();
          return;
        }

        if (isOpen) {
          closePanel();
        } else {
          openPanel();
        }
      });

      // --- Close button in panel ---
      closeBtn.addEventListener('click', function (e) {
        e.stopPropagation();
        closePanel();
      });

      // --- "all" item click ---
      var allItem = panel.querySelector('[data-category="all"]');
      allItem.addEventListener('click', function (e) {
        e.stopPropagation();
        selectAll();
      });

      // --- Parent category clicks ---
      var parentItems = panel.querySelectorAll('.dropdown-item[data-category]:not([data-category="all"])');
      parentItems.forEach(function (item) {
        item.addEventListener('click', function (e) {
          e.stopPropagation();
          var category = item.getAttribute('data-category');
          var hasChildren = item.getAttribute('data-has-children') === 'true';

          // Deselect "all"
          isAllSelected = false;
          var allRadio = panel.querySelector('[data-category="all"] .dropdown-radio');
          if (allRadio) allRadio.classList.remove('dropdown-radio--selected');

          // Collapse all subcategories first
          collapseAllSubcategories();

          // Deselect all parent radios
          parentItems.forEach(function (pi) {
            pi.querySelector('.dropdown-radio').classList.remove('dropdown-radio--selected');
          });

          if (hasChildren) {
            // Expand this parent's subcategory and hide the parent row
            var sub = panel.querySelector('.dropdown-subcategory[data-parent="' + category + '"]');
            if (sub) {
              sub.classList.add('dropdown-subcategory--open');
              item.classList.add('dropdown-item--parent-selected');
              item.classList.add('dropdown-item--hidden');

              // Auto-select the parent radio inside the expanded panel
              var subParentRadio = sub.querySelector('.dropdown-subcategory__parent .dropdown-radio');
              if (subParentRadio) {
                subParentRadio.classList.add('dropdown-radio--selected');
              }
            }
            selectedParent = category;
            // Clear child selections when switching parents
            selectedChildren = [];
            // Deselect all child radios
            var childRadios = panel.querySelectorAll('.dropdown-subcategory__item .dropdown-radio');
            childRadios.forEach(function (r) {
              r.classList.remove('dropdown-radio--selected');
            });
          } else {
            // No children — just select this parent
            item.querySelector('.dropdown-radio').classList.add('dropdown-radio--selected');
            selectedParent = category;
            selectedChildren = [];
          }

          updateApplyButton();
        });
      });

      // --- Sub-category parent click (inside expanded panel) ---
      var subParents = panel.querySelectorAll('.dropdown-subcategory__parent');
      subParents.forEach(function (subParent) {
        subParent.addEventListener('click', function (e) {
          e.stopPropagation();
          var radio = subParent.querySelector('.dropdown-radio');
          var isSelected = radio.classList.contains('dropdown-radio--selected');

          // Deselect all child radios in this subcategory
          var parentSub = subParent.closest('.dropdown-subcategory');
          var childRadios = parentSub.querySelectorAll('.dropdown-subcategory__item .dropdown-radio');
          childRadios.forEach(function (r) {
            r.classList.remove('dropdown-radio--selected');
          });
          selectedChildren = [];

          if (isSelected) {
            radio.classList.remove('dropdown-radio--selected');
          } else {
            radio.classList.add('dropdown-radio--selected');
          }

          updateApplyButton();
        });
      });

      // --- Sub-category child clicks (single-select) ---
      var childItems = panel.querySelectorAll('.dropdown-subcategory__item');
      childItems.forEach(function (child) {
        child.addEventListener('click', function (e) {
          e.stopPropagation();
          var radio = child.querySelector('.dropdown-radio');
          var childName = child.getAttribute('data-child');
          var isSelected = radio.classList.contains('dropdown-radio--selected');

          // Deselect all sibling child radios first
          var parentSub = child.closest('.dropdown-subcategory');
          var siblingRadios = parentSub.querySelectorAll('.dropdown-subcategory__item .dropdown-radio');
          siblingRadios.forEach(function (r) {
            r.classList.remove('dropdown-radio--selected');
          });
          selectedChildren = [];

          if (isSelected) {
            // Was already selected — just deselect (toggle off)
          } else {
            radio.classList.add('dropdown-radio--selected');
            selectedChildren = [childName];

            // Deselect the parent radio inside the subcategory panel
            var subParentRadio = parentSub.querySelector('.dropdown-subcategory__parent .dropdown-radio');
            if (subParentRadio) {
              subParentRadio.classList.remove('dropdown-radio--selected');
            }
          }

          isAllSelected = false;
          updateApplyButton();
        });
      });

      // --- Apply button ---
      applyBtn.addEventListener('click', function (e) {
        e.stopPropagation();
        if (applyBtn.classList.contains('dropdown-apply--inactive')) return;

        // Determine what to show on the trigger
        var displayName = '';
        if (selectedChildren.length > 0) {
          displayName = selectedChildren[selectedChildren.length - 1];
        } else if (selectedParent) {
          displayName = selectedParent;
        }

        if (displayName) {
          setSelectedState(displayName);
        }

        closePanel();
      });

      // --- Click outside to close ---
      document.addEventListener('click', function (e) {
        if (isOpen && !dropdown.contains(e.target)) {
          closePanel();
        }
      });

      // Default open on page load
      openPanel();
    })();

    // ===== Search Dropdown (Creator) =====
    (function () {
      var dropdown = document.getElementById('dropdown-search');
      var trigger = document.getElementById('search-trigger');
      var panel = document.getElementById('search-panel');
      var closeBtn = document.getElementById('search-close');
      var applyBtn = document.getElementById('search-apply');
      var searchInput = document.getElementById('search-input');
      var triggerText = trigger.querySelector('.dropdown-trigger__text');
      var chevronPill = trigger.querySelector('.dropdown-trigger__icon-pill');
      var closeIcon = trigger.querySelector('.dropdown-close-icon');

      var isOpen = false;

      function openPanel() {
        closeAllDropdowns();
        isOpen = true;
        panel.classList.add('dropdown-panel--open');
        trigger.classList.add('dropdown-trigger--open');
        searchInput.focus();
      }

      function closePanel() {
        isOpen = false;
        panel.classList.remove('dropdown-panel--open');
        trigger.classList.remove('dropdown-trigger--open');
      }

      registerDropdown(closePanel);

      function setSelectedState(name) {
        trigger.classList.remove('dropdown-trigger--open');
        trigger.classList.add('dropdown-trigger--selected');
        triggerText.textContent = 'by \u201C' + name + '\u201D';
        chevronPill.style.display = 'none';
        closeIcon.style.display = 'block';
      }

      function resetToDefault() {
        trigger.classList.remove('dropdown-trigger--selected');
        trigger.classList.remove('dropdown-trigger--open');
        triggerText.textContent = 'all creators';
        chevronPill.style.display = 'inline-flex';
        closeIcon.style.display = 'none';
        searchInput.value = '';
        applyBtn.classList.add('dropdown-apply--inactive');
        closePanel();
      }

      // Trigger click
      trigger.addEventListener('click', function (e) {
        e.stopPropagation();
        if (trigger.classList.contains('dropdown-trigger--selected')) {
          resetToDefault();
          return;
        }
        if (isOpen) {
          closePanel();
        } else {
          openPanel();
        }
      });

      // Close button in panel
      closeBtn.addEventListener('click', function (e) {
        e.stopPropagation();
        closePanel();
      });

      // Input — toggle apply button
      searchInput.addEventListener('input', function () {
        if (searchInput.value.trim().length > 0) {
          applyBtn.classList.remove('dropdown-apply--inactive');
        } else {
          applyBtn.classList.add('dropdown-apply--inactive');
        }
      });

      // Prevent panel close when clicking inside input
      searchInput.addEventListener('click', function (e) {
        e.stopPropagation();
      });

      // Apply button
      applyBtn.addEventListener('click', function (e) {
        e.stopPropagation();
        if (applyBtn.classList.contains('dropdown-apply--inactive')) return;
        var value = searchInput.value.trim();
        if (value) {
          setSelectedState(value);
        }
        closePanel();
      });

      // Click outside to close
      document.addEventListener('click', function (e) {
        if (isOpen && !dropdown.contains(e.target)) {
          closePanel();
        }
      });
    })();

    // ===== Price Dropdown =====
    (function () {
      var dropdown = document.getElementById('dropdown-price');
      var trigger = document.getElementById('price-trigger');
      var panel = document.getElementById('price-panel');
      var closeBtn = document.getElementById('price-close');
      var applyBtn = document.getElementById('price-apply');
      var triggerText = trigger.querySelector('.dropdown-trigger__text');
      var chevronPill = trigger.querySelector('.dropdown-trigger__icon-pill');
      var closeIcon = trigger.querySelector('.dropdown-close-icon');

      var priceAny = document.getElementById('price-any');
      var priceAnyRadio = document.getElementById('price-any-radio');
      var priceRangeRadio = document.getElementById('price-range-radio');
      var priceMin = document.getElementById('price-min');
      var priceMax = document.getElementById('price-max');

      var isOpen = false;
      var isAnyPrice = true;

      function openPanel() {
        closeAllDropdowns();
        isOpen = true;
        panel.classList.add('dropdown-panel--open');
        trigger.classList.add('dropdown-trigger--open');
      }

      function closePanel() {
        isOpen = false;
        panel.classList.remove('dropdown-panel--open');
        trigger.classList.remove('dropdown-trigger--open');
        // Reset inputs when closing without apply (if still on "any price")
        if (isAnyPrice) {
          priceMin.value = '';
          priceMax.value = '';
        }
      }

      registerDropdown(closePanel);

      function selectAnyPrice() {
        isAnyPrice = true;
        priceAnyRadio.classList.add('dropdown-radio--selected');
        priceRangeRadio.classList.remove('dropdown-radio--selected');
        applyBtn.classList.add('dropdown-apply--inactive');
      }

      function selectRange() {
        isAnyPrice = false;
        priceAnyRadio.classList.remove('dropdown-radio--selected');
        priceRangeRadio.classList.add('dropdown-radio--selected');
      }

      function updateApplyFromInputs() {
        var minVal = priceMin.value.trim();
        var maxVal = priceMax.value.trim();
        if (minVal.length > 0 || maxVal.length > 0) {
          selectRange();
          applyBtn.classList.remove('dropdown-apply--inactive');
        } else {
          if (!isAnyPrice) {
            applyBtn.classList.add('dropdown-apply--inactive');
          }
        }
      }

      function setSelectedState(display) {
        trigger.classList.remove('dropdown-trigger--open');
        trigger.classList.add('dropdown-trigger--selected');
        triggerText.textContent = display;
        chevronPill.style.display = 'none';
        closeIcon.style.display = 'block';
      }

      function resetToDefault() {
        trigger.classList.remove('dropdown-trigger--selected');
        trigger.classList.remove('dropdown-trigger--open');
        triggerText.textContent = 'any price';
        chevronPill.style.display = 'inline-flex';
        closeIcon.style.display = 'none';
        priceMin.value = '';
        priceMax.value = '';
        selectAnyPrice();
        closePanel();
      }

      // Trigger click
      trigger.addEventListener('click', function (e) {
        e.stopPropagation();
        if (trigger.classList.contains('dropdown-trigger--selected')) {
          resetToDefault();
          return;
        }
        if (isOpen) {
          closePanel();
        } else {
          openPanel();
        }
      });

      // Close button in panel
      closeBtn.addEventListener('click', function (e) {
        e.stopPropagation();
        closePanel();
      });

      // "Any price" click
      priceAny.addEventListener('click', function (e) {
        e.stopPropagation();
        selectAnyPrice();
      });

      // Price inputs
      priceMin.addEventListener('input', updateApplyFromInputs);
      priceMax.addEventListener('input', updateApplyFromInputs);

      priceMin.addEventListener('click', function (e) { e.stopPropagation(); });
      priceMax.addEventListener('click', function (e) { e.stopPropagation(); });

      // Apply button
      applyBtn.addEventListener('click', function (e) {
        e.stopPropagation();
        if (applyBtn.classList.contains('dropdown-apply--inactive')) return;

        var minVal = priceMin.value.trim();
        var maxVal = priceMax.value.trim();

        if (minVal && maxVal) {
          setSelectedState(minVal + '-' + maxVal);
        } else if (minVal) {
          setSelectedState(minVal + '+');
        } else if (maxVal) {
          setSelectedState('0-' + maxVal);
        }

        closePanel();
      });

      // Click outside to close
      document.addEventListener('click', function (e) {
        if (isOpen && !dropdown.contains(e.target)) {
          closePanel();
        }
      });
    })();

    // ===== Simple Dropdown Selection =====
    (function () {
      var wrapper = document.getElementById('select-dropdown-demo');
      var trigger = document.getElementById('select-trigger');
      var triggerText = document.getElementById('select-trigger-text');
      var panel = document.getElementById('select-panel');
      var options = panel.querySelectorAll('.select-dropdown__option');
      var isOpen = false;

      // Set initial selected value
      var selectedOption = panel.querySelector('.select-dropdown__option--selected');
      if (selectedOption) {
        triggerText.textContent = selectedOption.textContent;
        trigger.classList.add('select-dropdown__trigger--has-value');
      }

      function openPanel() {
        closeAllDropdowns();
        isOpen = true;
        wrapper.classList.add('select-dropdown--open');
        trigger.classList.add('select-dropdown__trigger--open');
        panel.classList.add('select-dropdown__panel--open');
      }

      function closePanel() {
        isOpen = false;
        wrapper.classList.remove('select-dropdown--open');
        trigger.classList.remove('select-dropdown__trigger--open');
        panel.classList.remove('select-dropdown__panel--open');
      }

      registerDropdown(closePanel);

      trigger.addEventListener('click', function (e) {
        e.stopPropagation();
        if (isOpen) {
          closePanel();
        } else {
          openPanel();
        }
      });

      // Option selection
      options.forEach(function (option) {
        option.addEventListener('click', function (e) {
          e.stopPropagation();
          // Remove selected from all
          options.forEach(function (o) { o.classList.remove('select-dropdown__option--selected'); });
          option.classList.add('select-dropdown__option--selected');
          triggerText.textContent = option.textContent;
          trigger.classList.add('select-dropdown__trigger--has-value');
          closePanel();
        });
      });

      // Click outside to close
      document.addEventListener('click', function (e) {
        if (isOpen && !wrapper.contains(e.target)) {
          closePanel();
        }
      });
    })();
  </script>
</body>
</html>
